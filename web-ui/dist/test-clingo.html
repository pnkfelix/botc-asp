<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clingo WASM Test</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; }
        textarea { width: 100%; height: 200px; font-family: monospace; padding: 10px; }
        button { padding: 10px 20px; font-size: 16px; margin: 10px 0; cursor: pointer; }
        pre { background: #f5f5f5; padding: 15px; overflow-x: auto; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Clingo WASM Integration Test</h1>
    <p>This page tests that clingo-wasm works in the browser.</p>

    <h3>ASP Program:</h3>
    <textarea id="program">% Simple BotC-style example
player(alice). player(bob). player(charlie).

% Exactly one player is the demon
{ demon(P) : player(P) } = 1.

% The demon is evil
evil(P) :- demon(P).

#show demon/1.
#show evil/1.</textarea>

    <br>
    <button id="runBtn" disabled>Loading Clingo...</button>

    <h3>Result:</h3>
    <pre id="output">Initializing...</pre>

    <script type="module">
        import * as clingo from '../node_modules/clingo-wasm/dist/clingo.web.js';

        const btn = document.getElementById('runBtn');
        const output = document.getElementById('output');
        const program = document.getElementById('program');

        // Initialize clingo
        async function init() {
            try {
                await clingo.init('./clingo.wasm');
                btn.textContent = 'Run Clingo';
                btn.disabled = false;
                output.textContent = 'Ready! Click "Run Clingo" to solve.';
                output.className = 'success';
            } catch (e) {
                output.textContent = 'Failed to initialize: ' + e.message;
                output.className = 'error';
            }
        }

        // Run clingo when button clicked
        btn.addEventListener('click', async () => {
            btn.disabled = true;
            btn.textContent = 'Running...';
            output.textContent = 'Solving...';
            output.className = '';

            try {
                const result = await clingo.run(program.value, 0); // 0 = all models
                output.textContent = JSON.stringify(result, null, 2);
                output.className = result.Result === 'SATISFIABLE' ? 'success' : '';
            } catch (e) {
                output.textContent = 'Error: ' + e.message;
                output.className = 'error';
            }

            btn.disabled = false;
            btn.textContent = 'Run Clingo';
        });

        init();
    </script>
</body>
</html>
